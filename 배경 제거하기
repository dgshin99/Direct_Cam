import cv2

# 이미지 파일 경로
image_path = "input_image.jpg"

# 얼굴 검출을 위한 Haar Cascade 파일 경로
cascade_path = cv2.data.haarcascades + "haarcascade_frontalface_default.xml"

# 이미지 로드
image = cv2.imread(image_path)

# 그레이스케일로 변환
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

# 얼굴 검출기 초기화
face_cascade = cv2.CascadeClassifier(cascade_path)

# 얼굴 검출
faces = face_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=5, minSize=(30, 30))

# 얼굴 영역 제외한 배경 지우기
mask = np.ones(image.shape[:2], dtype="uint8") * 255

for (x, y, w, h) in faces:
    cv2.rectangle(mask, (x, y), (x + w, y + h), 0, -1)

# 마스크를 이용하여 배경 제거
result = cv2.bitwise_and(image, image, mask=mask)

# 결과 출력
cv2.imshow("Result", result)
cv2.waitKey(0)
cv2.destroyAllWindows()
